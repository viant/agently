- id: general
  title: General
  layout:
    orientation: horizontal
    columns: 2
    labelPosition: top
  style:
    maxWidth: 860px
    margin: 0
    maxHeight: calc(100vh - 320px)
    overflowY: auto
    paddingRight: 8px
  items:
    - id: name
      label: Name
      type: text
      columnSpan: 2
      properties:
        placeholder: Daily bug scan

    - id: agentRef
      label: Agent
      type: text
      columnSpan: 2
      properties:
        placeholder: Select agent
      lookup:
        dialogId: agentLov
        size:
          width: '70%'
          height: '70%'
        title: Select Agent
        intent: success
        outputs:
          - name: agentRef
            location: id

    - id: taskPrompt
      label: Prompt
      type: textarea
      columnSpan: 2
      properties:
        rows: 8
        cols: 100
        placeholder: Describe what should run automatically.

    - id: description
      label: Description (optional)
      type: textarea
      columnSpan: 2
      properties:
        rows: 3
        cols: 100

    - id: id
      label: ID
      type: text
      columnSpan: 1
      on:
        - event: onVisible
          handler: schedule.showIfEdit
      properties:
        readOnly: true
        leftIcon: key

- id: schedule
  title: Schedule
  layout:
    orientation: horizontal
    columns: 2
    labelPosition: top
  style:
    maxWidth: 860px
    margin: 0
    maxHeight: calc(100vh - 320px)
    overflowY: auto
    paddingRight: 8px
  items:
    - id: enabled
      label: Enabled
      type: checkbox
      columnSpan: 1

    - id: visibility
      label: Visibility
      type: select
      columnSpan: 1
      options:
        - value: private
          label: Private
        - value: public
          label: Public

    - id: scheduleMode
      label: Mode
      type: radio
      columnSpan: 2
      on:
        - event: onChange
          handler: schedule.syncScheduleFields
        - event: onSelection
          handler: schedule.syncScheduleFields
        - event: onItemSelect
          handler: schedule.syncScheduleFields
      options:
        - value: daily
          label: Daily
        - value: interval
          label: Interval
        - value: custom
          label: Custom
      properties:
        appearance: segmented
        style:
          display: inline-flex
          alignItems: center
          gap: 6px
          padding: 4px
          border: 1px solid var(--light-gray1)
          borderRadius: 999px
          background: '#f3f4f6'
          justifySelf: start

    - id: dailyTime
      label: Run at (HH:MM or HH:MM AM/PM)
      type: text
      columnSpan: 1
      on:
        - event: onInput
          handler: schedule.syncScheduleFields
        - event: onKeyUp
          handler: schedule.syncScheduleFields
        - event: onBlur
          handler: schedule.syncScheduleFields
        - event: onChange
          handler: schedule.syncScheduleFields
        - event: onVisible
          handler: schedule.showIfDaily
      properties:
        placeholder: 09:00 AM

    - id: intervalHours
      label: Run every (hours)
      type: number
      columnSpan: 1
      on:
        - event: onInput
          handler: schedule.syncScheduleFields
        - event: onKeyUp
          handler: schedule.syncScheduleFields
        - event: onBlur
          handler: schedule.syncScheduleFields
        - event: onChange
          handler: schedule.syncScheduleFields
        - event: onVisible
          handler: schedule.showIfInterval
      properties:
        min: 1
        step: 1

    - id: weekdays
      label: On days
      type: multiSelect
      columnSpan: 2
      on:
        - event: onChange
          handler: schedule.syncScheduleFields
        - event: onSelection
          handler: schedule.syncScheduleFields
        - event: onItemSelect
          handler: schedule.syncScheduleFields
        - event: onVisible
          handler: schedule.showIfNonCustom
      options:
        - { value: mon, label: Mo }
        - { value: tue, label: Tu }
        - { value: wed, label: We }
        - { value: thu, label: Th }
        - { value: fri, label: Fr }
        - { value: sat, label: Sa }
        - { value: sun, label: Su }
      properties:
        appearance: pills
        placeholder: Select weekdays
        style:
          minHeight: 40px
          borderRadius: 999px
          paddingLeft: 0px
          paddingRight: 0px

    - id: cronExpr
      label: Cron Expression
      type: text
      columnSpan: 2
      on:
        - event: onInput
          handler: schedule.syncScheduleFields
        - event: onKeyUp
          handler: schedule.syncScheduleFields
        - event: onBlur
          handler: schedule.syncScheduleFields
        - event: onChange
          handler: schedule.syncScheduleFields
        - event: onVisible
          handler: schedule.showIfCustom
      properties:
        placeholder: 0 9 * * 1-5

    - id: timezone
      label: Timezone
      type: text
      columnSpan: 1
      properties:
        placeholder: America/New_York

    - id: startAt
      label: Start At (UTC)
      type: datetime
      columnSpan: 1

    - id: endAt
      label: End At (UTC)
      type: datetime
      columnSpan: 1

    # persisted fields for backend compatibility; hidden from UI
    - id: scheduleType
      type: text
      columnSpan: 1
      on:
        - event: onVisible
          handler: schedule.hideField
    - id: intervalSeconds
      type: number
      columnSpan: 1
      on:
        - event: onVisible
          handler: schedule.hideField

- id: security
  title: Security
  layout:
    orientation: horizontal
    columns: 2
    labelPosition: top
  style:
    maxWidth: 860px
    margin: 0
    maxHeight: calc(100vh - 320px)
    overflowY: auto
    paddingRight: 8px
  items:
    - id: _securityBanner
      type: markdown
      columnSpan: 2
      properties:
        value: "Automations run under the current workspace sandbox policy and use the configured user secrets (`userCredUrl`) for authenticated calls. Use least-privilege secrets and only grant required scopes."
        style:
          padding: '10px 12px'
          border: '1px solid #b7d1ff'
          borderRadius: '10px'
          background: '#f7fbff'
          color: '#1f2937'
          fontSize: '12px'
          marginBottom: '4px'

    - id: userCredUrl
      label: User Secrets URL
      type: text
      columnSpan: 2
      properties:
        placeholder: scy://secret/path|key

- id: execution
  title: Execution
  layout:
    orientation: horizontal
    columns: 2
    labelPosition: top
  style:
    maxWidth: 860px
    margin: 0
    maxHeight: calc(100vh - 320px)
    overflowY: auto
    paddingRight: 8px
  items:
    - id: modelOverride
      label: Model Override (optional)
      type: text
      columnSpan: 2
      lookup:
        dialogId: modelLov
        size:
          width: '70%'
          height: '70%'
        title: Select Model
        outputs:
          - name: modelOverride
            location: id

    - id: taskPromptUri
      label: Task Prompt URI (optional)
      type: text
      columnSpan: 2
