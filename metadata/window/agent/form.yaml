- id: basics
  title: Basics
  layout:
    orientation: horizontal
    columns: 2
    labelPosition: top
  items:
    - id: id
      label: ID
      type: text
    - id: icon
      label: Icon (URL / name)
      type: text

    - id: name
      label: Name
      type: text

    # Persona inline in Basics (moved from separate tab)
    - id: persona.actor
      label: Actor
      type: text
    - id: persona.role
      label: Role
      type: text

    - id: description
      label: Description
      type: textarea
      columnSpan: 2
      properties:
        rows: 2
        cols: 100


# -----------------------------------------------------------------------------
# Configuration – execution parameters
# -----------------------------------------------------------------------------
- id: config
  title: Configuration
  layout:
    orientation: horizontal
    columns: 2
    labelPosition: top
  items:
    - id: model
      label: Model
      type: text
      properties:
        style:
          backgroundColor: '#f0fff4'
          borderColor: '#c6f6d5'
      lookup:
        dialogId: modelLov
        size:
          width: '70%'
          height: '70%'
        title: Select Model
        outputs:
          - name: model
            location: id

    - id: temperature
      label: Temperature
      type: number
      properties:
        min: 0
        max: 1
        step: 0.01

    - id: toolCallExposure
      label: Tool Call Exposure
      type: select
      options:
        - value: turn
          label: Current Turn
        - value: conversation
          label: Whole Conversation

    - id: parallelToolCalls
      label: Parallel Tool Calls
      type: checkbox
      columnSpan: 2

# -----------------------------------------------------------------------------
# Profile – directory and runtime scope
# -----------------------------------------------------------------------------
- id: profile
  title: Profile
  layout:
    orientation: horizontal
    columns: 3
    labelPosition: top
  items:
    - id: profile.publish
      label: Publish in Directory
      type: checkbox
    - id: profile.name
      label: Display Name
      type: text
    - id: profile.rank
      label: Rank
      type: number
    - id: profile.description
      label: Description
      type: textarea
      columnSpan: 3
      properties:
        rows: 2
        cols: 100
    - id: profile.tags
      label: Tags (comma-separated)
      type: text
      columnSpan: 3
    - id: profile.conversationScope
      label: Conversation Scope
      type: select
      options:
        - value: new
          label: New (always create)
        - value: parent
          label: Reuse per parent conversation
        - value: parentTurn
          label: Reuse per parent turn
      columnSpan: 1

# (Source tab removed – not exposed in UI)

# -----------------------------------------------------------------------------
# Prompts – user and system prompts (URI-based)
# -----------------------------------------------------------------------------
- id: prompts
  title: Prompts
  layout:
    orientation: horizontal
    columns: 2
  containers:
    - id: promptLeft
      layout:
        orientation: vertical
        columns: 1
        labelPosition: top
      items:
        - id: prompt.uri
          label: Prompt (URI)
          type: text
          on:
            - event: onChange
              handler: agent.loadAgentEdit
        - id: userPromptResolved
          label: Resolved Path
          type: text
          properties:
            readOnly: true
      containers:
        - id: userPreview
          editor:
            selector:
              source: userPreviewSource
              extension: userPreviewExtension
            style:
              height: '320px'
        - id: previewBtn
          label: Preview
          type: button
          properties:
            text: Preview
          on:
            - event: onClick
              handler: agent.previewPrompts
    - id: promptRight
      layout:
        orientation: vertical
        columns: 1
        labelPosition: top
      items:
        - id: systemPrompt.uri
          label: System Prompt (URI)
          type: text
          on:
            - event: onChange
              handler: agent.loadAgentEdit
        - id: systemPromptResolved
          label: Resolved Path
          type: text
          properties:
            readOnly: true
      containers:
        - id: systemPreview
          editor:
            selector:
              source: systemPreviewSource
              extension: systemPreviewExtension
            style:
              height: '320px'

# (Persona tab removed – fields moved to Basics)

# -----------------------------------------------------------------------------
# Attachments – limits and delivery mode
# -----------------------------------------------------------------------------
- id: attachments
  title: Attachments
  layout:
    orientation: horizontal
    columns: 3
    labelPosition: top
  items:
    - id: attachment.limitBytes
      label: Limit (bytes)
      type: number
    - id: attachment.mode
      label: Attach Mode
      type: select
      options:
        - value: ref
          label: Reference
        - value: inline
          label: Inline
    - id: attachment.ttlSec
      label: TTL (seconds)
      type: number
    - id: attachment.toolCallConversionThreshold
      label: Tool Call -> PDF threshold (bytes)
      type: number

# -----------------------------------------------------------------------------
# MCP Resources – discovery and inclusion rules
# -----------------------------------------------------------------------------
- id: mcpResources
  title: MCP Resources
  layout:
    orientation: horizontal
    columns: 3
    labelPosition: top
  items:
    - id: mcpResources.enabled
      label: Enable MCP Resources
      type: switch
    - id: mcpResources.maxFiles
      label: Max Files
      type: number
    - id: mcpResources.trimPath
      label: Trim Path
      type: text
    # Advanced editor to cover locations and match options
    - id: mcpResources
      label: MCP Resources (advanced)
      type: object
      columnSpan: 3

# (Elicitation removed – no longer part of agent model)

- id: tools
  title: Tools
  dataSourceRef: agentTools
  layout:
    orientation: horizontal
    columns: 2
  containers:
    # ---------------------------------------------------------------------
    # Left side – table with all tool entries of the selected agent
    # ---------------------------------------------------------------------
    - id: toolsTable
      table: $import('table/tools.yaml')
      items: $import('form/tool_item.yaml')


- id: chain
  title: Chain
  layout:
    orientation: vertical
  containers:
    - id: chainsTable
      title: Chains
      dataSourceRef: agentChains
      sizing:
        height:
          size: 55
          unit: '%'
      table: $import('table/chains.yaml')
    - id: chainEditor
      title: Edit Chain
      dataSourceRef: agentChains
      tabs:
        vertical: false
      containers: $import('form/chain_tabs.yaml')


- id: knowledge
  title: Knowledge
  layout:
    orientation: vertical
    columns: 1
  containers:
    # Top: two tables side-by-side
    - id: knowledgeTop
      layout:
        orientation: horizontal
        columns: 2
      containers:
        - id: userKnowledge
          title: User Knowledge
          dataSourceRef: agentKnowledge
          table: $import('table/knowledge.yaml')
          on:
            - event: onRowSelect
              handler: agent.browseKnowledge
        - id: sysKnowledge
          title: System Knowledge
          dataSourceRef: agentSystemKnowledge
          table: $import('table/knowledge.yaml')
          on:
            - event: onRowSelect
              handler: agent.browseKnowledge
    # Bottom: browser controls and split editors
    - id: knowledgeBottom
      layout:
        orientation: vertical
        columns: 1
        labelPosition: top
      items:
        - id: knowledgeBrowserPath
          label: Path
          type: text
        - id: kbActions
          layout:
            orientation: horizontal
            columns: 2
          items:
            - id: kbRefresh
              label: Refresh
              type: button
              properties:
                text: Refresh
              on:
                - event: onClick
                  handler: agent.refreshKnowledgeBrowser
            - id: kbOpen
              label: Open
              type: button
              properties:
                text: Open Viewer
              on:
                - event: onClick
                  handler: agent.openKnowledgeDialog
      containers:
        - id: knowledgeEditors
          layout:
            orientation: horizontal
            columns: 2
          containers:
            - id: knowledgeList
              editor:
                selector:
                  source: knowledgeBrowserListSource
                  extension: knowledgeBrowserListExtension
                style:
                  height: '240px'
            - id: knowledgePreview
              editor:
                selector:
                  source: knowledgePreviewSource
                  extension: knowledgePreviewExtension
                style:
                  height: '240px'
        - id: copyKnowledgeContentBtn
          label: Copy
          type: button
          properties:
            text: Copy Content
          on:
            - event: onClick
              handler: agent.copyKnowledgePreview

# -----------------------------------------------------------------------------
# Authoring – read-only meta for paths, knowledge, elicitation, A2A
# -----------------------------------------------------------------------------
- id: authoring
  title: Authoring
  layout:
    orientation: horizontal
    columns: 2
    labelPosition: top
  items:
    - id: editMeta.contextInputs
      label: Context Inputs
      type: object
      columnSpan: 2
    - id: editMeta.a2a
      label: A2A
      type: object
      columnSpan: 2
