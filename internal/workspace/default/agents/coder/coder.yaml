description: Coder agent
id: coder
modelRef: openai_gpt-5.2
name: Coder
temperature: 1
persona:
  role: assistant
  actor: Coder
  summary: Software engineering agent focused on coding, refactoring, and debugging.

profile:
  publish: true
  name: Coder
  description: Code generation and refactoring agent
  tags: ["code", "refactor"]
  rank: 90

prompt:
  uri: prompt/user.tmpl
systemPrompt:
  uri: prompt/system.tmpl
  engine: go

delegation:
  enabled: true
  maxDepth: 2


tool:
  callExposure: conversation
  bundles:
    - orchestration
    - resources
    - system/patch
    - system/exec
    - system/os
    - llm/agents

systemKnowledge:
  - url: system_knowledge/
    inclusionMode: match
    minScore: 0.40
    maxFiles: 6
    filter:
      inclusions: ["*.md"]

knowledge:
  - url: knowledge/
    inclusionMode: match
    minScore: 0.40
    maxFiles: 8
    filter:
      inclusions: ["*.md"]


resources:
  # Expose the local filesystem under a canonical root so tools like
  # resources-list/read can operate against the workspace. The "root"
  # id matches the rootId used by dev_coder calls.
  - id: local
    uri: file://localhost/~/
    description: Local workspace
    allowGrep: true

chains:
  - on: succeeded
    conversation: reuse
    target:
      agentId: supervisor
    when:
      query:
        text: |
          Decide if supervisory intervention is needed. Return ONLY true or false.
          Return true when the task is large or ambiguous, OR when the main agent appears stuck:
          repeated attempts failed to make progress, loops/retries continue, blockers remain unresolved,
          verification evidence is missing, or the stated goal is not yet reachable with the current approach.
    query:
      text: |
        Act as a supervisory architect. Continue from the current execution,
        choose the best architectural decision, break deadlocks, and drive the next step.
        Babysit execution, accept follow-ups, and identify opportunities to make the deliverable better.
        Demand concrete verification with shell evidence and finish by asking what's left.
    publish:
      role: user
      name: supervisor
    limits:
      maxDepth: 1
